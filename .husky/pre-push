. "$(dirname "$0")/_/husky.sh"


CHANGESET_DIR=$(pwd)/.changeset
  CHANGESET_FILE=$(find "$CHANGESET_DIR" -type f -name "*.md" -printf "%T@ %p\n" | sort -n | tail -1 | cut -f2- -d' ')

  echo "üìÑ –ù–∞–π–¥–µ–Ω —Ñ–∞–π–ª: $CHANGESET_FILE"

  FILE_LINES=$(wc -l < "$CHANGESET_FILE")
  while [ $FILE_LINES -lt 5 ]; do
    echo "" >> "$CHANGESET_FILE"
    FILE_LINES=$((FILE_LINES + 1))
  done

  # –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ 2-—é –ø–æ–∑–∏—Ü–∏—é —á–µ—Ä–µ–∑ awk
  awk 'NR == 2 { print "\"test-changelog-vite\": patch" } { print }' "$CHANGESET_FILE" > "$CHANGESET_FILE.tmp" && mv "$CHANGESET_FILE.tmp" "$CHANGESET_FILE"

  # –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ 5-—é –ø–æ–∑–∏—Ü–∏—é —á–µ—Ä–µ–∑ awk
  awk -v msg="$COMMIT_MSG" 'NR == 5 { print msg } { print }' "$CHANGESET_FILE" > "$CHANGESET_FILE.tmp" && mv "$CHANGESET_FILE.tmp" "$CHANGESET_FILE"

  git add "$CHANGESET_FILE"